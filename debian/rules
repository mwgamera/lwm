#!/usr/bin/make -f

PACKAGE = lwm

export DEB_BUILD_MAINT_OPTIONS	= hardening=+all
export DEB_CFLAGS_MAINT_APPEND	= -Wall -pedantic
export DEB_LDFLAGS_MAINT_APPEND = -Wl,--as-needed

include debian/debian-vars.mk

override_dh_auto_build:
	CC=gcc /usr/bin/xmkmf
	# The only place where to inject extra flags
	$(MAKE) CC="$(CC) -I. $(CFLAGS) $(CPPFLAGS) $(LDFLAGS)"

override_dh_auto_install:
	$(MAKE) DESTDIR=$(PKGDIR) install
	$(MAKE) DESTDIR=$(PKGDIR) install.man
	mv --verbose $(MAN1DIR)/lwm.1x $(MAN1DIR)/lwm.1

	#  Install GDM support
	$(INSTALL_DIR) $(XSESSIONDIR)
	$(INSTALL_DATA) debian/*.desktop $(XSESSIONDIR)

override_dh_installwm:
	dh_installwm --priority=80 lwm

%:
	dh $@

# End of file
